<html>
	<head>
		<meta charset="UTF-8">
		<title>D3 APP</title>
		<script src = "https://d3js.org/d3.v5.min.js"></script>
		<style>
			body{
			font-size: 20px sans-serif;
			}
			svg{
			display: block;
			margin-left: 10%;
			margin-bottom: 50px
			}
			h1{
				font-family: verdana;
				margin-left: 11%;
				}      
		</style>
	</head>
	<body>
		<script type="text/javascript">
			var margin={
			top:20,
			bottom:20,
			left:30,
			right:80
			}
			 var maxDay=10;
			  var width = 500;
			  var height = 250;
			  var graphwidth=width-margin.left-margin.right;
			  var graphheight=height-margin.top-margin.bottom;
			  var xScale = d3.scaleLinear()
					  .domain([0,20])
					  .range([0,graphwidth]);
			  var yScale2=d3.scaleLinear()
					 .domain([0,50])
					 .range([graphheight,0]);
			  var color = d3.scaleOrdinal(d3.schemeCategory10);
			  var dataP = d3.json("classData.json");
			  var index = 0;
			  var drawChart = function(data,person){
			  var svg = d3.select("svg")
					  .attr("width",width)
					  .attr("height",height);
			  // rects
			  var plotLand=svg.append("g")
			  .classed("plot",true)
			  .attr("transform","translate("+margin.left+","+margin.top+")");
			  var hwgrades = [];
			  for each (var item in dataP[index]["homework"]){
				hwgrades.push(item.grade);
			}			  
			  var rect = plotLand.selectAll("rect")
				.data(hwgrades)
				.enter()
				.append("rect")
				.attr("x",function(d,i){
				  return xScale(i);
				})
				.attr("y",function(d){
				  return yScale2(d);
				})
				.attr("width",graphwidth/4-4)
				.attr("height",function(d){
				  return graphheight-yScale2(d);
				})
				//.attr("fill",function(d){
				 //return color(d.name);
				//})
//				var legend=svg.append("g")
//								  .classed("legend",true)
//								  .attr("transform","translate("+(width-margin.right)+","+margin.top+")");
//				var legendLines=legend.selectAll("g")
//											 .data(data[person]["homework"])
//											 .enter()
//											 .append("g")
//											 .classed("legendLine",true)
//											 .attr("transform",function(d,i){
//											 return "translate(0,"+(i*20)+")";});
//				legendLines.append("rect")
//							  .attr("x",0)
//							  .attr("y",0)
//							  .attr("width",10)
//							  .attr("height",10)
//							  .attr("fill",function(d){return color(d.name);});
//				legendLines.append("text")
//							  .attr("x",20)
//							  .attr("y",10)
//							  .text(function(d){ return d.name;});
			var yAxis=d3.axisLeft(yScale2)
					 .ticks(20);
			svg.append("g")
			.classed("axis",true)
			.call(yAxis)
			.attr("transform","translate("+(margin.left-5)+","+margin.top+")");
			  }
			  var cg = function(indexChange){
				 var y = document.getElementById("name").innerText;
				 console.log(y)
				 var dataP = d3.json("classData.json");
				 y = dataP[index+indexChange]["picture"]
				 dataP.then(function(d){
					change(d,index+indexChange)
				 })
				}
				var hwgrades = [];
				for each (var item in data[index]["homework"]){
					hwgrades.push(item.grade);
				}
				var change = function(data,index){
				d3.selectAll("rect")
					.data(hwgrades)
					.transition()
					.attr("x",function(d,i){
					  return xScale(i);
					})
					.attr("y",function(d){
					  return yScale2(d);
					})
					.attr("width",graphwidth/4-4)
					.attr("height",function(d){
					  return graphheight-yScale2(d);
					})
//					.attr("fill",function(d){
//					  return color(d.name);
//					})
					var days=document.getElementById("dates");
					days.innerText=data[day-1].day;
					document.getElementById("prev").disabled = false;
					document.getElementById("next").disabled = false;
					if(index==0)
					{
					  document.getElementById("prev").disabled = true;
					}
					else if(index==dataP.length-1)
					{
					  document.getElementById("next").disabled = true;
					}}
			  dataP.then(function(d){
				 drawChart(d,0)
			  })
		</script>
		<svg width="600" height="500"></svg>
		<div style="display:inline">NAME:</div>
		<div id="name" style="display:inline" >
		  1
		</div>
		<button onclick="cg(-1)" type="button" id="prev" disabled="true">PREV</button>
		<button onclick="cg(1)" type="button" id="next">NEXT</button><br>
	</body>
</html>
